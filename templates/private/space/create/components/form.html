{% load custom_tags %}
{% include 'components/forms/error_widget.html' with errors=form.non_field_errors %}


<form id="space-form" action="" method="POST">
    {% csrf_token %}

    <!-- TITLE -->
    <div class="mt-2 mb-6">
        <div class="flex items-center space-x-2">
            <label for="{{ form.title.id_for_label }}"
            class="hidden mb-2 text-sm font-medium text-gray-900 dark:text-white">{{ form.title.label }} </label>
            {{ form.title }}
            {% include 'components/tooltip.html' with title=form.title.label content=form.title.help_text target=form.title.name placement="bottom" %}
        </div>
        {% include 'components/forms/error_widget.html' with errors=form.title.errors %}
    </div>
    

    <!-- INVITATIONS -->
    <div class="mb-6">
        <div class="flex items-center mb-2 space-x-2">
            <h3 class="text-xl font-medium text-gray-900 dark:text-white">Invitations</h3>
            {% include 'components/tooltip.html' with title="Invitations" content=form.senders_emails.help_text target=form.senders_emails.name%}
        </div>
        <div id="email-input-container" class="my-1 border-0">
            <!-- Text input field -->
            {{ form.email_input }}
            <!-- Tags will appear here, below the input field -->
            <div id="tags" class="flex flex-wrap gap-2 my-1"></div>
            <!-- Error message-->
            {% include 'components/forms/error_widget.html' with errors=form.senders_emails.errors %}
            <!-- Hidden input for form submission -->
            {{ form.senders_emails }}      
        </div>
                        <div class="flex items-center mb-2 space-x-2">
            <div class="flex items-center h-5">
                {{ form.notify_invitation }}
                <label for="{{ form.notify_invitation.id_for_label }}"
                class="hidden text-sm font-medium text-gray-900 ms-2 dark:text-gray-300">{{ form.notify_invitation.label }}</label>
            </div>
            {% include 'components/tooltip.html' with title="Notify Invitation" content=form.notify_invitation.help_text target=form.notify_invitation.name%}
        </div>
        <div class="flex items-center mb-2 space-x-2">
            <div class="flex items-center h-5">
                {{ form.is_public }}
                <label for="{{ form.is_public.id_for_label }}"
                class="hidden text-sm font-medium text-gray-900 ms-2 dark:text-gray-300">{{ form.is_public.label }}</label>
            </div>
            {% include 'components/tooltip.html' with title="Public Link" content=form.is_public.help_text target=form.is_public.name%}
        </div>

    </div>



    <!-- INSTRUCTIONS -->
    <div class="mb-6">
        <div class="flex items-center mb-2 space-x-2">
            <h3 class="text-xl font-medium text-gray-900 dark:text-white">Instructions</h3>
            {% include 'components/tooltip.html' with title=form.instructions.label content=form.instructions.help_text target=form.instructions.name%}
        </div>
        <label for="{{ form.instructions.id_for_label }}"
        class="hidden block mb-2 text-sm font-medium text-gray-900 dark:text-white">{{ form.instructions.label }} </label>
        {{ form.instructions }}
        {% include 'components/forms/error_widget.html' with errors=form.instructions.errors %}
    </div>

    <!-- DEADLINE -->
    <div class="mb-6" id="deadline-section">
        <div class="flex items-center mb-2 space-x-2">
            <h3 class="text-xl font-medium text-gray-900 dark:text-white">Dealine</h3>
            {% include 'components/tooltip.html' with title=form.deadline.label content=form.deadline.help_text target=form.deadline.name%}
        </div>
        <div id="deadline-input-container" class="my-1 border-0">
            <label for="{{ form.deadline.id_for_label }}"
            class="hidden block mb-2 text-sm font-medium text-gray-900 dark:text-white">{{ form.deadline.label }} </label>
            {{ form.deadline }}
            {% include 'components/forms/error_widget.html' with errors=form.deadline.errors %}
        </div>
        <div class="hidden deadline-settings-container">

            <div class="flex items-center my-2 space-x-2">
                <div class="flex items-center h-5">
                    {{ form.notify_deadline }}
                    <label for="{{ form.notify_deadline.id_for_label }}"
                    class="hidden text-sm font-medium text-gray-900 ms-2 dark:text-gray-300">{{ form.notify_deadline.label }}</label>
                </div>
                {% include 'components/tooltip.html' with title="Deadline Notification" content=form.notify_deadline.help_text target=form.notify_deadline.name%}
                {% include 'components/forms/error_widget.html' with errors=form.notify_deadline.errors %}
            </div>

            <div class="container flex-col items-center hidden mb-2 space-x-2 deadline-notice-container">
                <div class="flex flex-wrap items-center mx-1">
                    <span class="mr-0.5">Notifications</span>
                    <span class="mx-0.5">will</span>
                    <span class="mx-0.5">be</span>
                    <span class="mx-0.5">sent</span>
                    <span class="mx-0.5">{{ form.deadline_notice_days }}</span>
                    <span class="mx-0.5">days</span>
                    <span class="mx-0.5">and</span>
                    <span class="mx-0.5">{{ form.deadline_notice_hours }}</span>
                    <span class="mx-0.5">hours</span>
                    <span class="mx-0.5">before</span>
                    <span class="mx-0.5">the</span>
                    <span class="mx-0.5">deadline.</span>
                    <span class="ml-0.5 px-2" id="deadline-notification-date-container"></span> <!-- filled via JS-->
                </div>            
                
            </div>
            {% include 'components/forms/error_widget.html' with errors=form.deadline_notice_days.errors %}





            <div class="flex items-center mb-2 space-x-2">
                <div class="flex items-center h-5">
                    {{ form.upload_after_deadline }}
                    <label for="{{ form.upload_after_deadline.id_for_label }}"
                    class="hidden text-sm font-medium text-gray-900 ms-2 dark:text-gray-300">{{ form.upload_after_deadline.label }}</label>
                </div>
                {% include 'components/tooltip.html' with title="Allow uploads after deadline" content=form.upload_after_deadline.help_text target=form.upload_after_deadline.name%}
                {% include 'components/forms/error_widget.html' with errors=form.upload_after_deadline.errors %}
            </div>
        </div>

        
    </div>
        


        {% include 'private/space/create/components/request_form.html' with action=action %}
{% include "components/buttons/generic.html" with button_text="Add Request" button_id="add-request-btn"  extra_classes="my-2"%}


    {% if action == 'edit' %}    
    <div class="sticky bottom-4">
        <div class="flex justify-center">
            <div class= "w-[300px] mx auto">
                {% include "components/buttons/submit.html" with button_text=submit_text %}
            </div>
        </div>
    </div>
    {% else %}
        {% include "components/buttons/submit.html" with button_text=submit_text %}    
    {% endif %}
</form>