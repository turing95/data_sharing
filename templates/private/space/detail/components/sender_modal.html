{% load static l10n %}
{% load custom_tags static %}

<div id="sender-modal-{% if sender %}{{sender.uuid}}{% else%}public{%endif%}" tabindex="-1" class="fixed top-0 left-0 right-0 z-[100] w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full">
    <div class="relative w-full h-auto max-w-2xl border border-gray-300 md:max-h-full"> 
        <div class="relative bg-white shadow dark:bg-gray-700">
            <div class="flex items-center justify-between p-2 border-b md:p-3 dark:border-gray-600">
                <div class="w-full text-center">
                    <h3 class="text-xl font-bold text-gray-900 uppercase dark:text-white">
                        {% if sender %}{{sender.email}}{% else %}Public Link{% endif %}
                    </h3>
                    <p class="text-sm text-gray-600 dark:text-gray-300">
                        <!-- subtitle-->
                    </p>
                </div>
                <button type="button" class="inline-flex items-center justify-center w-6 h-6 text-sm text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 ms-auto dark:hover:bg-gray-600 dark:hover:text-white" data-modal-hide="sender-modal-{% if sender %}{{sender.uuid}}{% else%}public{%endif%}">
                    <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                    </svg>
                    <span class="sr-only">Close modal</span>
                </button>
            </div>
            <div class="flex flex-col p-3 md:p-2">

                <div class="flex flex-col">
                    <h3 class="mb-2 text-lg font-bold text-gray-900 border-b border-gray-200 dark:text-white">
                        Notifications
                    </h3>
                    <div class="grid grid-cols-1 gap-4 md:grid-cols-2">
                        <div class="flex flex-col">
                            <h4 class="mb-2 text-base font-medium text-gray-900 border-b border-gray-200 dark:text-white">
                                Invitation
                            </h4>
                            <span class="my-1 ml-2 text-xs">
                                Last invitation:
                                <span class="ml-2 text-xs underline">
                                    {% if sender.notified_at %}{{sender.notified_at|localize}}{% else %}Never invited{% endif %}
                                </span>
                            </span>
        
                            <button class="my-2 ml-2 w-[140px] text-sm px-2.5 py-1.5 text-center text-marian-blue-400 bg-white hover:text-white hover:bg-marian-blue-300 focus:outline-none focus:ring-marian-blue-300 dark:bg-marian-blue-400 dark:hover:bg-marian-blue-300 dark:focus:ring-marian-blue-200 border border-marian-blue-400" 
                                hx-post="{% url 'notify_invitation' sender.pk %}"
                                hx-target="#messageBar"
                                hx-swap="outerHTML">
                                Send Invitation
                            </button>                          


                        </div>
                        <div class="flex flex-col">

                            <h4 class="mb-1 text-base font-medium text-gray-900 border-b border-gray-200 dark:text-white">
                                Deadline Reminder
                            </h4>
                            <span class="my-1 ml-2 text-xs">
                                Last notification:
                                <span class="ml-2 text-xs underline">
                                    {% if sender.notified_at %}{{sender.notified_at|localize}}{% else %}Never notified{% endif %}
                                </span>
                            </span>
                            <button class="my-2 ml-2 w-[140px]  text-sm px-2.5 py-1.5 text-center text-marian-blue-400 bg-white hover:text-white hover:bg-marian-blue-300 focus:outline-none focus:ring-marian-blue-300 dark:bg-marian-blue-400 dark:hover:bg-marian-blue-300 dark:focus:ring-marian-blue-200 border border-marian-blue-400" 
                                hx-post="{% url 'notify_deadline' sender.pk %}"
                                hx-target="#messageBar"
                                hx-swap="outerHTML">
                                    Send reminder 
                            </button>
                        </div>
                    </div>
                    
                </div>



                {% comment %} <div class="flex flex-col">
                    <h3 class="mb-2 text-lg font-bold text-gray-900 border-b border-gray-200 dark:text-white">
                        Invitation
                    </h3>
                    <span class="my-1 ml-2 text-xs">
                        Last invitation:
                        <span class="ml-2 text-xs underline">
                            {% if sender.notified_at %}{{sender.notified_at|localize}}{% else %}Never invited{% endif %}
                        </span>
                    </span>

                    <button class="my-2 ml-2 w-[150px] px-5 py-2 font-medium text-center text-white bg-marian-blue-400 hover:bg-marian-blue-300 focus:outline-none focus:ring-marian-blue-300 dark:bg-marian-blue-400 dark:hover:bg-marian-blue-300 dark:focus:ring-marian-blue-200" 
                        hx-post="{% url 'notify_invitation' sender.pk %}"
                        hx-target="#messageBar"
                        hx-swap="outerHTML">
                        Send Invitation
                    </button>
                </div>
                
                <div  class="flex flex-col">
                    <h3 class="mt-4 mb-2 text-lg font-bold text-gray-900 border-b border-gray-200 dark:text-white">
                        Deadline Reminder
                    </h3>
                    <span class="my-1 ml-2 text-xs">
                        Last notification:
                        <span class="ml-2 text-xs underline">
                            {% if sender.notified_at %}{{sender.notified_at|localize}}{% else %}Never notified{% endif %}
                        </span>
                    </span>
                    <button class="ml-2 my-1 w-[150px] px-5 py-2 font-medium text-center text-white bg-marian-blue-400 hover:bg-marian-blue-300 focus:outline-none focus:ring-marian-blue-300 dark:bg-marian-blue-400 dark:hover:bg-marian-blue-300 dark:focus:ring-marian-blue-200" 
                        hx-post="{% url 'notify_deadline' sender.pk %}"
                        hx-target="#messageBar"
                        hx-swap="outerHTML">
                            Send reminder 
                    </button>
                </div> {% endcomment %}

                <div  class="flex flex-col">
                    <h3 class="mt-4 mb-1 text-lg font-bold text-gray-900 border-b border-gray-200 dark:text-white">
                        Space link
                    </h3>
                    {% url 'sender_space_detail_private' space.uuid sender.uuid as sender_path%}
                    <div class="my-1 ml-2 text-xs">
                        Link to space:
                        <div class="inline-flex items-center">
                            <a href="{{ sender_path}}" target = "_blank" class="ml-1 text-blue-600 transition-colors duration-300 hover:text-blue-800">
                                space link
                            </a>
                            <button 
                                class="inline-flex items-center ml-2 text-gray-600 transition-all transition-colors duration-75 duration-300 rounded hover:text-gray-800 group active:ring-2 active:ring-offset-2 active:ring-gray-300"
                                onclick="navigator.clipboard.writeText('{{ request.get_host }}{{ sender_path }}')"
                                title="Copy Link">
                                <img src="{% static 'images/icons/copy-link.svg' %}" alt="Copy Link Icon" class="w-4 h-4 transition-transform duration-300 group-hover:scale-110">
                            </button>              
                        </div>
                    </div>

                    <div class="inline-flex items-center my-1 ml-2 text-xs">
                        <span class="mr-2">Link status:</span>
                        {% render_sender_activate_toggle sender 'sender_toggle' sender.is_active color_on="green" color_off="orange" toggle_color_on="marian-blue" toggle_color_off="gray" label_on="active" label_off="inactive" soft_off_label=False label_colored=True label_wrap=True %}
                    </div>
                </div>

                <div  class="flex flex-col">
                    <div class="flex items-center mt-4 mb-1 border-b border-gray-200">
                        <h3 class="text-lg font-bold text-gray-900 dark:text-white">
                            Uploads
                        </h3> 
                            
                        <!-- Loading Indicator -->
                        <div id="loading-indicator-sender-modal" class="items-center justify-center opacity-0 htmx-indicator">
                            <div role="status" class="ml-2 spinner">
                                {% include 'components/loading_spinner_light.html' with w="w-5" h="h-5" %}
                                <span class="sr-only">Loading...</span>
                            </div>
                        </div>
                    </div>
                    
            
                    <div class="" hx-get="{% url 'history_table' space.uuid %}?sender_uuid={{sender.uuid}}"
                        hx-trigger="intersect once"
                        hx-target="#history-table-sender-modal"
                        hx-indicator="#loading-indicator-sender-modal">
                    

                    </div>
                    <div id="history-table-sender-modal">            
                    </div>
                </div>
            
              
                  
                  
            
            </div>
        </div>
    </div>
</div>